## 初识Kafka

##### 发布与订阅消息系统

在讨论Kafka之前我们先来了解一下发布与订阅消息系统的概念

消息的生产者不会直接把消息发送给消息的接收者而是以某种规则对消息进行分类,接收者订阅它们一遍接收特定类型的消息。发布与订阅系统一般会有一个broker（发布消息的中心点）

##### 消息和批次

kafka是一款基于发布与订阅的消息系统,kafka的数据单元称为消息,消息由字节数据组成,为了提高效率消息会被分批的写入kafka,批次就是一组消息这些消息属于同一个主题和分区,如果每个消息都单独穿梭于网络会导致大量的网络开销,如果把消息分批次传输可以减少网络开销但是延迟就会增大所以要在时间延迟与吞吐量之间做出权衡,批次越大单位时间内处理的消息就越多单个消息的传输时间就越长

##### 主题和分区

* kafka的消息通过主题进行分类,主题可以被分为若干个分区,消Kafka通过分区来实现数据冗余和伸缩性,消息以追加的方式写入分区,然后以FIFO的方式进行顺序读取,因为一个主题可以包含很多分区所以无法保证主题范围内的消息读取顺序

* 分区可以分布在不同的服务器上,所以一个主题可以横跨很多的服务器,以此来提供比单个服务器更强大的性能

##### broker和集群

* 一个独立的kafka机器被称为broker,broker接收来自生产者的消息,为消息设置偏移量并提交消息到磁盘保存

* broker为消费者提供服务对读取分区的请求做出响应返回已提交到磁盘上的消息

* broker是集群的组成部分,每个集群都有一个broker同时充当集群控制器的角色,在集群中一个分区从属于一个broker,该broker被称为该分区的首领，一个分区可以分配个多个broker

* 在一定期限内保留消息是kafka的一个重要特性，默认的保留策略是保留一段时间或者消息达到一定的字节数旧消息就会过期并删除，主题可以配置自己的保留策略可以保留消息到不使用为止
